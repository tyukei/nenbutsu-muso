<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="version" content="1.1.39">
    <!-- 修正前: <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"> -->
    <!-- 修正後: -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <title>煩悩シューティング</title>
    <link rel="icon" type="image/png" sizes="16x16" href="images/favicon-16x16.png">
    <link rel="icon" type="image/png" sizes="32x32" href="images/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="192x192" href="images/favicon-192x192.png">
    <link rel="apple-touch-icon" sizes="180x180" href="images/apple-touch-icon.png">
    <link rel="stylesheet" href="assets/css/main.css">
</head>

<body>
    <main>
        <div id="gameContainer">
            <!-- タイトル画面 -->
            <div id="titleScreen" class="screen">
                <div id="titleIntroOverlay">
                    <div class="intro-black"></div>
                    <img id="introMonkHappy" class="intro-monk intro-happy" src="images/monk/monk_happy.png"
                        alt="happy monk">
                    <img id="introMonkSad" class="intro-monk intro-sad" src="images/monk/monk_sad.png" alt="sad monk">
                    <img id="introMonkPray" class="intro-monk intro-pray" src="images/monk/monk_pray.png"
                        alt="praying monk">
                    <div id="titleIntroMessage" class="intro-message instruction">
                        <p id="titleIntroMessageTextMain" class="intro-message-main"></p>
                        <p id="titleIntroMessageTextSub" class="intro-message-sub"></p>
                    </div>
                    <div class="intro-skip-hint">タップでスキップ</div>
                </div>
                <div id="titlePersistentPray">
                    <img class="persistent-happy" src="images/monk/monk_happy.png" alt="happy monk">
                    <img class="persistent-sad" src="images/monk/monk_sad.png" alt="sad monk">
                    <img class="persistent-pray" src="images/monk/monk_pray.png" alt="praying monk">
                </div>

                <div id="titleMainContent">
                    <!-- Floating Menu Button Removed -->
                    <h1 class="title-logo">
                        <img src="images/logo.png" alt="煩悩シューティング" class="title-logo-img">
                    </h1>

                    <div class="instruction">
                        <p class="title-main-copy">
                            降り注ぐ<span class="text-bonnou-red">煩悩</span>の雨……<br>
                            迷わず撃て！悟りはその先にある。
                        </p>
                        <p class="title-sub-copy">
                            究極の徳（ハイスコア）を目指せ！
                        </p>
                    </div>

                    <div class="title-buttons">
                        <button id="startBtn" class="title-button">修行の開始</button>
                        <button id="rankingBtn" class="title-button">修行の軌跡</button>
                        <button id="menuBtn" class="title-button title-button-menu">修行の準備</button>
                    </div>

                    <div id="version-display"></div>
                </div>
            </div>

            <!-- レベル選択画面 -->
            <div id="levelScreen" class="screen hidden">
                <h1>修行の道</h1>
                <h2>難易度を選べ</h2>

                <div class="level-buttons">
                    <button id="levelEasy" class="level-btn">
                        <span class="level-name">仏性Lev1</span>
                        <span class="level-desc">煩悩36体 / ゆっくり</span>
                    </button>
                    <button id="levelNormal" class="level-btn">
                        <span class="level-name">仏性Lev2</span>
                        <span class="level-desc">煩悩72体 / 普通</span>
                        <span class="level-lock">仏性Lev1をクリアで解放</span>
                    </button>
                    <button id="levelHard" class="level-btn">
                        <span class="level-name">仏性Lev3</span>
                        <span class="level-desc">煩悩108体 / 高速</span>
                        <span class="level-lock">仏性Lev2をクリアで解放</span>
                    </button>
                    <button id="levelDemon" class="level-btn hidden">
                        <span class="level-name">Lev悪魔</span>
                        <span class="level-desc">煩悩324体 / 加速地獄</span>
                    </button>
                </div>


                <button id="backFromLevelBtn">戻る</button>
            </div>

            <!-- パスワード入力モーダル -->
            <div id="passwordModal" class="screen hidden">
                <div class="password-container">
                    <h2>レベル解放</h2>
                    <p>
                        パスワードを入力してレベルを解放<br>
                        <span class="password-hint">※各レベルに対応するパスワードがあります</span>
                    </p>
                    <input type="password" id="passwordInput" placeholder="パスワードを入力" maxlength="20">
                    <div class="password-buttons">
                        <button id="passwordSubmitBtn">確認</button>
                        <button id="passwordCancelBtn">キャンセル</button>
                    </div>
                    <div id="passwordMessage"></div>
                </div>
            </div>

            <!-- ゲームオーバー画面 -->
            <div id="gameOverScreen" class="screen hidden">
                <h1 id="resultTitle"></h1>
                <h2 id="resultText"></h2>
                <img id="resultImage" class="result-image" src="" alt="result">
                <div id="currentScore"></div>
                <div class="share-buttons">
                    <button id="shareBtn" class="share-btn">共有</button>
                    <button id="restartBtn">再修行</button>
                    <button id="toTitleBtn">タイトル</button>
                </div>
            </div>

            <!-- 初期設定モーダル -->
            <div id="settingsModal" class="hidden">
                <div class="settings-container">
                    <h2>環境設定</h2>

                    <div class="setting-group">
                        <span class="setting-label">音声設定</span>
                        <div class="toggle-options">
                            <button class="toggle-btn active" data-group="sound" data-value="on">ON (BGMあり)</button>
                            <button class="toggle-btn" data-group="sound" data-value="off">OFF (無音)</button>
                        </div>
                        <div class="settings-desc">※「ON」の場合、開始時に音声が再生されます</div>
                    </div>

                    <div class="setting-group">
                        <span class="setting-label">操作モード</span>
                        <div class="toggle-options">
                            <button class="toggle-btn" data-group="mode" data-value="pc">PC (キーボード)</button>
                            <button class="toggle-btn" data-group="mode" data-value="mobile">スマホ (タップ)</button>
                        </div>
                        <div class="settings-desc">※デフォルトはPCです</div>
                    </div>

                    <button id="settingsSubmitBtn">決定</button>
                </div>
            </div>

            <!-- 利用規約モーダル -->
            <div id="tosModal" class="modal hidden">
                <div class="modal-container">
                    <h2 class="modal-title">利用規約</h2>
                    <div class="tos-content">
                        <p><strong>第1条（目的）</strong></p>
                        <p>本規約は、当ゲーム「煩悩シューティング」の利用に関する条件を定めるものです。</p>
                        <br>
                        <p><strong>第2条（免責）</strong></p>
                        <p>本ゲームの利用により生じた損害について、開発者は一切の責任を負いません。</p>
                        <br>
                        <p><strong>第3条（禁止事項）</strong></p>
                        <p>公序良俗に反する行為、不正アクセス、その他開発者が不適切と判断する行為を禁止します。</p>
                        <br>
                        <p><strong>第4条（変更）</strong></p>
                        <p>本規約は予告なく変更される場合があります。</p>
                        <br>
                        <p>ゲームをお楽しみいただく前に、上記内容をご確認ください。</p>
                    </div>
                    <button id="tosAgreeBtn">同意する</button>
                </div>
            </div>

            <!-- チュートリアルモーダル -->
            <div id="tutorialModal" class="modal hidden">
                <div class="modal-container">
                    <h2 class="modal-title">修行の心得</h2>

                    <div class="carousel-container">
                        <img src="images/tutorial/slide1.png" class="carousel-slide active" alt="基本操作">
                        <img src="images/tutorial/slide2.png" class="carousel-slide" alt="煩悩を撃て">
                        <img src="images/tutorial/slide3.png" class="carousel-slide" alt="六波羅蜜を集めよ">
                    </div>

                    <div class="carousel-dots">
                        <span class="dot active"></span>
                        <span class="dot"></span>
                        <span class="dot"></span>
                    </div>

                    <div class="carousel-controls">
                        <button id="prevSlideBtn" class="carousel-nav-btn">前へ</button>
                        <button id="nextSlideBtn" class="carousel-nav-btn">次へ</button>
                    </div>
                </div>
            </div>

            <!-- 修行の軌跡画面 -->
            <div id="rankingScreen" class="screen hidden">
                <h1>修行の軌跡</h1>
                <h2>己の過去と向き合う</h2>

                <div id="rankingList"></div>

                <button id="backToTitleBtn">タイトルに戻る</button>
            </div>

            <canvas id="gameCanvas" width="480" height="640"></canvas>

            <div id="info" class="hidden">
                <div><span id="levelDisplay"></span> | 煩悩シューティング: <span id="score">0</span> / <span
                        id="targetScore">108</span>
                </div>
                <div>精神力: <span id="spirit">3</span> | 功徳: <span id="kudoku" class="info-kudoku">0</span>/6 | 連鎖数: <span
                        id="combo">0</span></div>
            </div>

            <!-- 仮想コントローラー（スマホ用） -->
            <div id="virtualControls" class="hidden">
                <div id="leftBtn" class="control-btn">◀</div>
                <div id="rightBtn" class="control-btn">▶</div>
                <div id="shootBtn" class="control-btn">読経発射</div>
                <div id="specialBtn" class="control-btn disabled">煩悩即菩薩</div>
            </div>
        </div>

        <!-- メニューモーダル -->
        <div id="menuModal" class="modal hidden">
            <div class="modal-container menu-modal-compact">
                <h2 class="menu-modal-title">メニュー</h2>
                <div class="menu-modal-actions">
                    <button id="menuSettingsBtn" class="menu-btn">設定</button>
                    <button id="menuTosBtn" class="menu-btn">利用規約</button>
                    <button id="menuTutorialBtn" class="menu-btn">修行の心得</button>
                    <button id="menuDeveloperBtn" class="menu-btn">開発者モード</button>

                    <button id="closeMenuBtn" class="menu-btn menu-close-btn">閉じる</button>
                </div>
            </div>
        </div>

        <!-- 煩悩メッセージ表示 -->
        <div id="bonnouMessageContainer"></div>
    </main>
    <script src="assets/js/config.js"></script>
    <script src="assets/js/events.js"></script>
    <script src="assets/js/state.js"></script>
    <script src="assets/js/audio.js"></script>
    <script src="assets/js/device.js"></script>
    <script src="assets/js/entities.js"></script>
    <script src="assets/js/renderer.js"></script>
    <script src="assets/js/ui.js"></script>
    <script src="assets/js/game.js"></script>
    <script src="assets/js/input.js"></script>
    <script src="assets/js/main.js"></script>
</body>

</html>